<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <title>IamTest</title>
   
  <!-- For the JavaScript APIs for Office, go to https://aka.ms/officejs-overview to learn more. -->
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js" type="text/javascript"></script> 

    <script src="jquery-3.6.0.js" type="text/javascript"></script>
    
    <script src="MessageRead.js" type="text/javascript"></script>
    <script src="MessageBanner.js" type="text/javascript"></script>
    <script>
         var testObject = ["project 1", "project 2", "project 3"]
        
         window.onload = function(){   
            var projectSel =document.getElementById('FiledeliveryLocation');
            for (var x in testObject){
            projectSel.options[projectSel.options.length]= new Option(x,x);              
            }
        }
        
    </script>

    
    <link href="Content/Button.css" rel="stylesheet" type="text/css" />
    <link href="Content/MessageBanner.css" rel="stylesheet" type="text/css" />

    <link rel="stylesheet" href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/9.6.0/css/fabric.min.css">
    <style>
        body {
  background-image: url("https://snajken.github.io/Images/HexBackgroundTiles.jpeg");
}
.button {
  border: none;
  color: white;
  padding: 15px 32px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 16px;
  margin: 4px 2px;
  cursor: pointer;
}

.button1 {background-color: #04AA6D;} /* Green */
.button2 {background-color: #008CBA;} /* Blue */
        body {
  background-image:Images/HexBackgroundTiles.jpeg;
}
</style>
</head>
<body class="ms-font-m ms-welcome">
     <h1>Outlook Send Data add-in</h1>
    
<form name="fileDecisions" id="fileForm" action="/url" method="GET">
 Projects:<select id="FiledeliveryLocation" name="ActiveProject">
          <option value="" selected="selected">null</option>
         </select>
     <br><br>
    <label>
          Please enter the new filename
          <input type="text" name="name" minlength="1" maxlength="30" required>
    </label>
        <button type="submit">Submit</button>  
    </form>
    <script>
        function attachmentFunction() {
            const item = Office.context.mailbox.item;
            let outputString = "";

            if (item.attachments.length > 0) {
                for (let i = 0; i < item.attachments.length; i++) {
                    const attachment = item.attachments[i];
                    outputString += "<BR>" + i + ". Name: ";
                    outputString += attachment.name;
                    outputString += "<BR>ID: " + attachment.id;
                    outputString += "<BR>contentType: " + attachment.contentType;
                    outputString += "<BR>size: " + attachment.size;
                    outputString += "<BR>attachmentType: " + attachment.attachmentType;
                    outputString += "<BR>isInline: " + attachment.isInline;
                }
            }
            console.log(outputString);
        var projectSel =document.getElementById('FiledeliveryLocation');
        var size = projectSel.options.leangth;
            projectSel.appendChild(size,size);
        }

    </script>

    <button class="button button1" onclick="attachmentFunction()">get attachment</button>

</body>

</html>
